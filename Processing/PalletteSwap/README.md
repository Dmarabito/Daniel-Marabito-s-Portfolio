# So this project is about taking two images and replacing the colors of one with that of another.

# PalletteSwap.pde is the first version of the code. The feature that I find lacking in this is the visual of when it is running. I was having trouble getting the text to display properly to show progress. I believe this has to do with me putting most of the code in setup. It also take a while to run. So when you run it it will have you select an image, and then a second image. Then you look at a grey screen for a while. After that while it will pop up a window to save it, and show the finished result. I am thinking I will make a second version that displays progress messages using multiple threads. This way the processing itself can happen in one thread and while that is going on the draw function can occasionally read a progress variable and draw text to the screen. 

# Now I think is a good time to talk about what PalletteSwap.pde is doing. So it uses the selectInput function to get a source image. I figured out selectInput seems to run on it's own thread, so I set up what would otherwise be an infinite loop in the main thread to ensure that it catches up. It then does the same thing for the pallete image.

# After getting the images it grabs the pixel array of each image. Then it reduces the array so that each color is only represented once. I came to the conclusion that working with a reduced array when possible would likely make it quicker. I started really worrying about speed when I figured out that some of the steps were taking like an hour.

# after making the reduced pallets it basically makes a pallet of equivalents. Basically this is an array of colors coresponding to what color is closest among the pallette colors. Determining how close it was basically involved adding together the absolute value of the diffrence between the two colors in terms of each channel. Here is the actual line float DistanceToColor = abs(qred(OGColor)-qred(PalletColors[0])) + abs(qgreen(OGColor)-qgreen(PalletColors[0])) + abs(blue(OGColor)-blue(PalletColors[0])) ; So for the red channel it takes the original color's red value and subtracts the pallet colors red channel. It then gets an absolute value for that. It does the same for blue and green. Then adds them together. If you are wondering about the qred bit, reading the documentation apparently there is a faster way to get the red value then using red(). Since I was having speed issues I mad the qred function which just uses the quicker method described in the documents. The quicker version is  float r2 = c >> 16 & 0xFF; I will fully admit I don't understand it. I know that it is applying a bit shift to the color as well that is going through an and gate. I am not sure what the 0xFF means per say. It might just be a hexdecimal number. I don't really know. I don't really grasp how the individual color channels map onto a color value. Basically this is saying for the moment that line is a bit of a black box to me. I don't entirely know how it works but it does.

# anyways after that tangent on how it gets the equivalent colors it then goes to the main images pixel array and replaces them based on the reduced array. So it matches the current color to the color in the reduced array which then coresponds to what the color should become in the final image.

# after it is done replacing it the code insists that you save the image using selectoutput to choose where. The way I coded it basically makes it loop back to selecting an output if you try to cancel. I may in the next version make it a bit kinder and let you choose not to save it with then a click on the image to recall it. We shall see. Also the image is displayed on screen.

# MeInPalletteA.png is an example of the output of PalletteSwap.pde, it was made with a picture of me and a pallete made in inkscape using screenshots of pallete from https://coolors.co/

# I did discover in making various images that it works best if you have a image with fewer colors as your pallette, otherwise the resulting image could look alot like the original image just due to the colors happening to be in the image, or very similar colors being in the image.

# So I made PalletteSwapV2.pde the main improvement is I took most of the code out of the setup() function and made it into its own thread. This then allowed me to add a Status variable to store where the code is, and to let the draw function run at the same time to update the image to display the text. Alot of the code was copy/pasted from the previous version with minor tweaks.
